<div class="container pb-5">

  <div class="row"><!--全体を囲み横並びにするrow-->
    <!--お買いものリスト＆期限の部分テンプレート-->
    <div class="col-4 mt-3 pb-5">
      <%= render 'homes/list_and_limit', lists: @lists, stocks: @stocks %>
    </div>

    <div class="col-7 offset-1  pb-5"><!--追加した-->
    <div>
      <div class="row justify-content-center mt-3">
        <h3 class="text-center"><i class="fas fa-carrot mx-3"></i>食材一覧</h3>
        <span class="mx-3"><%= link_to "ストック一覧へ",stocks_path, class:"btn btn-sm btn-outline-secondary" %></span>
      </div>
      <div class="row justify-content-center">
        <p class="text-center ">食材名をクリックすると詳細・編集画面へ</p>
      </div>
      <div class="row justify-content-center mb-2">
        <%= render 'categories/btn', categories: @categories %>
      </div>
      <div class="row justify-content-center pb-5">
        <table class="table table-hover justify-content-center mx-5 pb-5">
          <tr>
            <th></th>
            <th>食材</th>
            <th class="text-center">ストックへ</th>
            <th class="text-center">お買いものリストへ</th>
            <th>削除</th>
          </tr>
          <% @foods.each do |food| %>
            <tbody>
            <tr>
              <td id="like_btn_<%= food.id %>">
                <%= render "likes/btn", food: food %>
              </td>
              <td>
                <%= link_to food_path(food.id) do %>
                  <%= food.name %>
                <% end %>
                <p class="col-1 text-nowrap">在庫:<%= food.stocks.any? ? "○" : "×" %></p>
              </td>
              <td class="text-center">
                <div class="position-relative">
                <%= link_to "#stock_item-#{food.id}", class:"btn btn-sm btn-outline-secondary", "data-toggle": "collapse", role: "button", "aria-expanded": "false", "area-controls": "stock_item-#{food.id}", style: "z-index:1; color:#EF8C04; border-color:#EF8C04; " do %>
                  + <i class="fas fa-cubes"></i> 追加
                <% end %>
                <div class="collapse position-absolute" id="stock_item-<%= food.id %>" style="left:-145px; z-index:2;">
                    <div class="card card-body">
                      <%= render 'foods/add_form', model: food.stocks.build %>
                      <%= form_with(model: food.stocks.build, local: true) do |f| %>
                      <!--↑アソシエーションの記述があればbuildで作れる-->
                        <%= f.hidden_field :food_id %>
                        <%= f.hidden_field :category_id %>
                      <div class="form-row align-items-baseline">
                        <%= f.label :amount, "個数　" %>
                        <%= f.number_field :amount , style: "width:50px;" %>
                      </div>
                      <!--ここから単位-->
                        <%#= f.radio_button :unit, "ko" %>
                        <%#= f.label :unit_ko, "個" %>
                        <%#= f.radio_button :unit, "hon" %>
                        <%#= f.label :unit_hon, "本" %>
                        <%#= f.radio_button :unit, "fukuro" %>
                        <%#= f.label :unit_fukuro, "袋" %>
                        <%#= f.radio_button :unit, "tama" %>
                        <%#= f.label :unit_tama, "玉" %>
                        <%#= f.radio_button :unit, "mai" %>
                        <%#= f.label :unit_mai, "枚" %>
                      <!--単位終わり-->
                      <div class="form-row align-items-baseline">
                        <%= f.label :buy_day, "購入日" %>
                        <%= f.date_field :buy_day %>
                      </div>
                      <div class="form-row align-items-baseline">
                        <%= f.label :limit, "期限　" %>
                        <%= f.date_field :limit %>
                      </div>
                        <%= f.text_area :memo,placeholder: '備考欄' %>
                      <div class="form-row justify-content-center align-items-baseline">
                        <%= f.submit %>
                      </div>
                      <% end %>
                    </div>
                  </div>
                </div>
              </td>
              <td class="text-center">
                <div class="position-relative">
                  <%= link_to "#list_add-item-#{food.id}", class:"btn btn-sm btn-outline-secondary", "data-toggle": "collapse", role: "button", "aria-expanded": "false", "area-controls": "list_add-item-#{food.id}", style: "z-index:1; color:#EF8C04; border-color:#EF8C04;" do %>
                    + <i class="fas fa-clipboard-list"></i> 追加
                  <% end %>
                  <div class="collapse position-absolute" id="list_add-item-<%= food.id %>" style="z-index:2;">
                    <div class="card card-body">
                      <%= form_with(model: food.lists.build, local: true) do |f| %>
                        <%= f.hidden_field :food_id %>
                      <div class="form-row align-items-baseline">
                        <%= f.label :amount, "個数　" %>
                        <%= f.number_field :amount , style: "width:50px;" %>
                      </div>
                      <!--ここから単位-->

                      <!--単位終わり-->
                      <div class="form-row justify-content-center align-items-baseline">
                        <%= f.submit %>
                      </div>
                      <% end %>
                    </div>
                  </div>
                </div>
              </td>
              <td>
                <%= link_to food_path(food.id),method: :delete, class:"btn btn-sm btn-outline-secondary", data:{confirm: "#{food.name}を削除しますか？"} do %>
                  <i class="fas fa-trash-alt"></i>
                <% end %>
              </td>
            </tr>
          </tbody>
          <% end %>
        </table>
        <%= paginate @foods %>
      </div>
    </div>
    <div class="row justify-content-center">
        <h3 class="text-right pb-3"><i class="fas fa-plus mx-3"></i>食材・カテゴリの追加</h3>
      </div>
      <div class="row justify-content-center">
          <div class="col-4 text-center mt-3 pb-3">
            <h4><i class="fas fa-carrot mr-1"></i>食材の追加</h4>
            <%= render 'foods/form', food: @food_new %>
          </div>
        <!--category-->
        <div class="col-4 text-center mt-3 pb-3">
          <div class="pb-3">
            <h4><i class="fas fa-align-justify mr-1"></i>カテゴリの追加</h4>
            <%= render 'categories/form', category: @category_new %>
          </div>
        </div>
        <!--category-->
      </div>
  </div>
  </div>
</div><!--全体のrow-->
